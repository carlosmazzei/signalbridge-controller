name: "Build"

on:
  push:

env:
  # Customize the CMake build type here (Release, Debug, RelWithDebInfo, etc.)
  BUILD_TYPE: Release

jobs:
  build:
    name: "Build"
    runs-on: "ubuntu-latest"
    steps:
      - name: Clean workspace
        run: |
          echo "Cleaning up previous run"
          rm -rf "${{ github.workspace }}"
          mkdir -p "${{ github.workspace }}"

      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup submodules
        run: |
          echo "Setting up submodules"
          git submodule update --init --recursive

      - name: Build
        run: |
          echo "Installing building tools"
          sudo apt install cmake python3 build-essential gcc-arm-none-eabi libnewlib-arm-none-eabi libstdc++-arm-none-eabi-newlib
          mkdir build
          cd build
          echo "Running cmake"
          cmake ..
          make
        